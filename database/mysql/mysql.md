[toc]

# 1. 存储引擎

## 1. Innodb存储引擎

InnoDB，是MySQL的数据库引擎之一，现为MySQL的默认存储引擎。

innodb_page_size：根据局部性原理，每次IO以页为单位（操作系统默认4KB，innodb为16KB）。

![image-20191212185947575](mysql.assets/image-20191212185947575.png)

在查找数据时（单页），可以根据二分法，检索页目录，再查找对应的数据。

### 1. 索引

- 主键索引

主键索引为聚集索引，主键索引会默认排序（插入的数据会按照主键进行排序后保存在磁盘）。入插入主键字段数据3，2，1，则在保存时，会按照1，2，3进行保存，select出来的数据也是这个数据。如果没有自定义主键，则选取一个unique字段为主键，否则innodb会新增加一列rowid（隐藏列，由其它主键的情况下，不会添加该列）作为主键。

- 聚集索引

索引和数据都是集中在一起，如果表有主键，则默认聚集索引为主键索引，否则找下一个非NULL索引，如果没有其它索引，则默认以rowid为聚集索引进行保存数据。

- B+树索引

主键索引默认为B+树。Innodb默认为三层深度，如果行数据超过2000w行，则升级为四层深度（影响效率）。

聚集索引的B+树。可以看到索引和数据在一起。

![image-20191212200725219](mysql.assets/image-20191212200725219.png)

非聚集索引的B+树。可以看到索引和数据不在一起，是和主键在一起，所以要再通过主键回表，到聚集索引再查询一次，所以效率不高。

![image-20191212200749034](mysql.assets/image-20191212200749034.png)







